<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
        <script src="https://unpkg.com/aframe-look-at-component@0.8.0/dist/aframe-look-at-component.min.js"></script>
        <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar-nft.js"></script>
    </head>
    <body style="margin: 0; overflow: hidden;">
        <a-scene
            vr-mode-ui="enabled: false"
            arjs="sourceType: webcam; videoTexture: true; debugUIEnabled: false;"
            renderer="antialias: true; alpha: true"
            embedded>
                <a-image
                    src="assets/arrow3.png"
                    look-at="[gps-camera]"
                    scale="1 1 1"
                    gps-entity-place="latitude: -6.761643; longitude: 39.193781;"
                ></a-image>
            <a-camera gps-camera rotation-reader></a-camera>
        </a-scene>
        <div style="position: fixed; bottom: 10px; left: 10px; width: 100%; text-align: left; z-index: 1; color: white; background-color: rgba(0,0,0,0.5); padding: 5px;">
            <p id="debug" style="font-size: 10px;">Waiting for GPS data...</p>
        </div>
        <script>
            // Debugging
            const debugEl = document.getElementById('debug');
            console.log('Debug element:', debugEl);

            function updateDebugInfo(info) {
                console.log('Updating debug info:', info);
                if (debugEl) {
                    debugEl.textContent = info;
                } else {
                    console.error('Debug element not found');
                }
            }

            window.addEventListener('load', () => {
                console.log('Window loaded');
                updateDebugInfo('Page loaded. Waiting for GPS data...');
            });


            window.addEventListener('gps-camera-update-position', e => {
                const cameraLat = e.detail.position.latitude;
                const cameraLon = e.detail.position.longitude;
                const distanceMsg = document.querySelector('a-image').getAttribute('distance');
                debugEl.textContent = 'Camera: ' + cameraLat.toFixed(6) + ', ' + cameraLon.toFixed(6) + ' (Dist: ' + distanceMsg + ')';
            });
            
            // Additional error handling
            window.addEventListener('error', function(event) {
                console.error('Caught error:', event.error);
                updateDebugInfo('An error occurred. Check console for details.');
            });
        </script>
    </body>
</html>
